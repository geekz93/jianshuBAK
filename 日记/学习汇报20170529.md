## 一 梳理低比特压缩算法进行图片压缩的步骤
1. **样本训练:** 有 m 张训练样本图片, 对每张样本图片进行按照 8x8 像素分块, 分为 n 个块序列, 对序列中同一位置的块, 设置 k 值进行 lgb_kmeans 聚类算法,  得到 2^k 个中心, 作为该块的训练集, 对序列中的所有块都进行聚类操作, 得到 n 个训练集, 完成训练
![](http://upload-images.jianshu.io/upload_images/3022282-0841c4c9c0e6b0fd.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240)
2. **图像编码:** 对于待压缩图片先对图片进行分块, 得到块序列, 序列中的每个块在它对应的训练集中, 根据欧式距离最短原则找出一个最相似的块代替它, 记录这个相似块在训练集中的序号.
由于每个块的训练集中的中心数量为 2^K 个, 因此相似块的序号最大不会超过 2^K, 而表示大小为 2^K 的数, 只需要使用 K 的bit即可, 由于块的序号的连续的, 因此用来记录序号的比特也是连续的, 这样进一般节省空间. 压缩编码过程就是每个块, 在它对应的训练集中找相似块的并记录序号的过程, 编码最后得到一个比特串, 比特流的长度为 n 个 k之和
![](http://upload-images.jianshu.io/upload_images/3022282-278fcc334cb2727c.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240)

3. **图像解码:** 根据每个训练集中中心的个数 k, 从比特串中依次获取 k 个比特, 将它还原成数字即相似块的序号, 然后从对应训练集中找到该块, 依次放在相应位置上, 完成解码
![](http://upload-images.jianshu.io/upload_images/3022282-90d639225f7438ec.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240)

## 二 实验：测试 K 值与压缩后图像质量的关系
- **设置参数：** 样本集合：lena, pepper, house, woman 各4张，共16张。图像尺寸128x128 像素，分块尺寸 8x8 像素
- **实验结果：** 
![](http://upload-images.jianshu.io/upload_images/3022282-ccdab143c0975e82.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240)
- **结论：** K 值选取越大， 压缩后图片的质量越好。
但是 K 值增大， 使得训练得到的字典的占用空间增大， 实验中，当 K为4时，才能完全还原原始图片，但这时训练字典的体积，已经比 16 张样本图片体积的和还大， 已经失去压缩的意义了。因此，在选取 K 值得时候需要权衡压缩质量，和训练字典所占用的存储空间

## 三 算法改进 - 根据样本的离散度自适应选取 K 值
在样本训练阶段：原算法每组小块选取的 k 值是固定的，改进算法， 根据小块之间的离散度选择 k 值，使用标准差作为离散度的判断标准，实现自适应的选取k值。离散度越小，选取小的 k 值， 离散度越大，选取大的 k 值， k值的取值范围在 [1, 10]

## 四 聚类的应用2：缺陷定位
在分块，聚类的基础上，根据对应块的相似度进行缺陷定位
- **原理：** 对无缺陷的图片，进行分块聚类， 得到的每个小块的训练集中的小块是各种正常图片区域，当这个区域存在缺陷的时候，缺陷块与训练集中的每个小块的相似性会很低，因此可以设置阈值， 当计算相似性的值小于这个阈值时， 就判定这个小块为疑似缺陷块
- **判断图片相似性的方法：** 直方图、PSNR和SSIM、感知哈希、SIFT
- **实验方案：** 按照压缩应用的方法进行样本训练， 对每个图片相似性方法进行实验， 测试缺陷定位的效果
