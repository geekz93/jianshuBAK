## DAY-2 熟悉出检测报告
检测报告包括内容：
- 文件系统的使用率：
    * 输出：服务器中的挂载点和使用率(挂载点是文件系统的入口，因此文件系统和挂载点对应)，只关注使用率在 80% 以上的文件系统
    * 过程：连接测试域(局域网, 通过 vpn 连接) -> 登录服务器(使用 ssh 连接) -> 查看文件系统 `df -h`
    * 自动化方案: python 调用系统命令(?shell?可执行文件?), 得到系统的信息, 通过 python 处理字符串, 输出成 CSV 格式文件
    * python命令: os.popen() 输入系统命令(字符串), 系统命令的执行结果以**文件对象的形式返回**

> popen() 只能得到系统指令的输出结果, 而不能得到系统指令的返回值, 如果系统命令执行失败程序将报错
> 将有关联的任务合并处理, 直接导出 xls 文件 (如何判断任务的关联性)

- 表空间使用率：
    * 输出: 目标数据库中的表空间的使用情况, 只关注 80% 以上的文件系统
    * 过程: 登录数据库(sqlplus) -> 执行 sql 语句
    * 自动化方案: 使用 spool 格式化输出 CSV 格式文件, spool 默认将文件保存在当前目录 

> 数据库是安装在操作系统上的软件, 登录数据库的过程就想登录 QQ 一样, 是登录到一个软件上, 和登录到服务器区别
> 在命令行下使用 sqlplus 登录数据库, 如果在服务器中 bash 下直接输入 sqlplus 不能打开, 则需要找到 sqlplus 放置的目录在其中运行
> 在 os 上使用一个软件如果直接输入命令后无法执行，不代表 os 上没有装这个软件，可以使用 查找程序进行搜索，再进入对应路径执行（bash搜索路径在 .profile 中的 PATH 环境变量中设置）
> sqlplus 能够通过 ecuser/NMC_ecuser_db_88@ECDB 的形式登录数据库，是因为在 tnsnames 配置文件中配置了 ECDB 有关参数

- 数据库性能报告: 
    * 输出: 使用 oracle server 自带的工具 awrrpt(sql语句) 交互** 生成性能报告
    * 过程: 登录 oracle server 所处的服务器 -> 使用 sqlplus 登录数据库 -> 运行 awrrpt 工具
    * 自动化方案: 先考虑**交互式 -> 参数化**转变, 如果软件不支持, 可以考虑使用 **python 的交互模块**

> 登录 oracle server 所处的服务器并不是登录 oracle server, 只是需要用到 oracle server 带的工具 awrrpt, 通过 sqlplus 登录的数据库也不一定是这台机子上的  
> oracle 的基目录就是 oracle/home, 和 unix 的家目录一样
> 通过 oracle 的环境变量得到 oracle 的安装位置
> - awrrpt报错：0ra-00904
> 可能原因
>     1.数据库登录用户，不具备当前主机登录用户的写权限
>     2.数据库登录用户不具备数据库的查询权限, 需要跟换数据库的

